<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>é¥¶å“ç¥º & æ¨é¢œç¿ é¤å…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      body { 
        font-family: 'Noto Sans SC', sans-serif; 
        -webkit-tap-highlight-color: transparent;
        position: fixed;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .h-safe-screen { height: 100dvh; }
      @keyframes soft-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
      .animate-soft-bounce { animation: soft-bounce 3s infinite ease-in-out; }
      .fade-in { animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
      .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
      .shadow-soft { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05); }
      .shadow-red { box-shadow: 0 10px 15px -3px rgba(220, 38, 38, 0.3); }
      .progress-glow { box-shadow: 0 0 12px rgba(245, 158, 11, 0.3); }
      .pt-ios-safe { padding-top: env(safe-area-inset-top); }
      .pb-ios-safe { padding-bottom: env(safe-area-inset-bottom); }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900 overflow-hidden">
    <div id="root" class="h-safe-screen w-full"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      const MENU_DATA = [
        { id: 99, name: 'é¥¶å“ç¥ºäº²è‡ªä¸‹å¨', price: 20, category: 'å¿…é€‰é¡¹', desc: 'åº—é•¿ç‰¹ä¾›ï¼Œä»Šæ—¥å¨è‰ºç²¾è¿›ä¸­', must: true },
        { id: 1, name: 'è¾£æ¤’ç‚’è‚‰', price: 18, category: 'çƒ­èœ', desc: 'é²œå«©ä¸‹é¥­ï¼Œæ‹›ç‰Œå¿…ç‚¹' },
        { id: 2, name: 'å¯ä¹é¸¡ç¿…', price: 18, category: 'çƒ­èœ', desc: 'ç”œå’¸é€‚ä¸­ï¼Œçš®ç³¯è‚‰é¦™' },
        { id: 3, name: 'å¯ä¹é¸¡è…¿', price: 15, category: 'çƒ­èœ', desc: 'è‚‰è´¨åšå®ï¼Œæ±æ°´ä¸°å¯Œ' },
        { id: 4, name: 'ç•ªèŒ„ç‚’é¸¡è›‹', price: 12, category: 'çƒ­èœ', desc: 'ç»å…¸ç¾å‘³ï¼Œè€å°‘çš†å®œ' },
        { id: 5, name: 'æ°´ç…®ç‰›è‚‰', price: 25, category: 'çƒ­èœ', desc: 'éº»è¾£é²œé¦™ï¼Œå£æ„Ÿæ»‘å«©' },
        { id: 6, name: 'è¾£æ¤’ç‚’é¸¡è›‹', price: 12, category: 'çƒ­èœ', desc: 'ç®€å•çš„é¦™è¾£ç¾å‘³' },
        { id: 7, name: 'æ°´è’¸è›‹', price: 8, category: 'çƒ­èœ', desc: 'å£æ„Ÿæ»‘å«©ï¼Œå…¥å£å³åŒ–' },
        { id: 8, name: 'è¥¿å…°èŠ±ç‚’è™¾ä»', price: 22, category: 'çƒ­èœ', desc: 'æ¸…çˆ½è¥å…»ï¼Œè™¾ä»Qå¼¹' },
        { id: 9, name: 'å—æ˜Œæ‹Œç²‰', price: 8, category: 'ä¸»é£Ÿ', desc: 'åœ°é“å®¶ä¹¡å‘³ï¼Œé…èœè¶³' },
        { id: 10, name: 'å—æ˜Œç‚’ç²‰', price: 12, category: 'ä¸»é£Ÿ', desc: 'é”…æ°”åè¶³ï¼Œé¦™è¾£çˆ½å£' },
        { id: 11, name: 'é¦’å¤´', price: 2, category: 'ä¸»é£Ÿ', desc: 'æ¾è½¯æ‰‹å·¥å¤§é¦’å¤´' },
        { id: 12, name: 'é¢æ¡', price: 6, category: 'ä¸»é£Ÿ', desc: 'çƒ­è…¾è…¾çš„éª¨æ±¤é¢' },
        { id: 13, name: 'é¥ºå­', price: 12, category: 'ä¸»é£Ÿ', desc: 'çš®è–„é¦…å¤§æ‰‹å·¥æ°´é¥º' },
        { id: 14, name: 'æ±¤åœ†', price: 8, category: 'ä¸»é£Ÿ', desc: 'èŠéº»æµå¿ƒï¼Œç”œèœœæ¸©æš–' },
        { id: 15, name: 'æ³¡é¢', price: 5, category: 'ä¸»é£Ÿ', desc: 'æ·±å¤œé£Ÿå ‚åŒæ¬¾' },
        { id: 16, name: 'ç±³é¥­', price: 2, category: 'ä¸»é£Ÿ', desc: 'ç²¾é€‰äº”å¸¸å¤§ç±³' },
        { id: 17, name: 'å¯ä¹', price: 4, category: 'é¥®å“', desc: 'å†°é•‡å¿«ä¹æ°´' },
        { id: 18, name: 'çŸ¿æ³‰æ°´', price: 2, category: 'é¥®å“', desc: 'å¤©ç„¶ç”˜æ³‰' },
        { id: 19, name: 'å¼€æ°´', price: 0, category: 'é¥®å“', desc: 'æš–èƒƒå…è´¹' }
      ];

      function App() {
        const [step, setStep] = useState('welcome');
        const [cart, setCart] = useState({});
        const [activeCat, setActiveCat] = useState('å¿…é€‰é¡¹');
        
        // --- æ–¹æ¡ˆä¸€æ ¸å¿ƒä¿®æ”¹ï¼šåˆå§‹åŒ–æ—¶å°è¯•ä»æœ¬åœ°è¯»å–ç§¯åˆ† ---
        const [totalHistory, setTotalHistory] = useState(() => {
          const saved = localStorage.getItem('rpq_restaurant_points');
          return saved ? parseInt(saved) : 0;
        });

        // --- æ–¹æ¡ˆä¸€æ ¸å¿ƒä¿®æ”¹ï¼šå½“ç§¯åˆ†å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŒæ­¥åˆ°æœ¬åœ°å­˜å‚¨ ---
        useEffect(() => {
          localStorage.setItem('rpq_restaurant_points', totalHistory.toString());
        }, [totalHistory]);

        const currentTotal = Object.keys(cart).reduce((sum, id) => {
          const item = MENU_DATA.find(m => m.id == id);
          return sum + (item.price * cart[id]);
        }, 0);

        const hasMust = Object.keys(cart).some(id => MENU_DATA.find(m => m.id == id).must);

        if (step === 'welcome') return (
          <div className="h-full bg-gradient-to-br from-red-500 to-red-700 flex flex-col items-center justify-center text-white p-6 fade-in relative overflow-hidden">
            <div className="absolute top-[-10%] left-[-10%] w-64 h-64 bg-red-400 rounded-full blur-3xl opacity-20"></div>
            <div className="absolute bottom-[-10%] right-[-10%] w-64 h-64 bg-orange-400 rounded-full blur-3xl opacity-20"></div>
            <div className="mb-8 animate-soft-bounce text-8xl drop-shadow-2xl">ğŸ³</div>
            <h1 className="text-4xl font-black mb-3 tracking-tight text-center drop-shadow-md">
              é¥¶å“ç¥º & æ¨é¢œç¿<br/>
              <span className="text-2xl opacity-90 italic font-serif">Private Kitchen</span>
            </h1>
            <div className="w-12 h-1 bg-white/30 rounded-full mb-8"></div>
            <p className="text-red-50 mb-16 opacity-80 font-light tracking-[0.2em] text-sm uppercase">Smart Dining System</p>
            <button onClick={() => setStep('ordering')} 
              className="bg-white text-red-600 px-14 py-4 rounded-2xl text-xl font-black shadow-2xl active:scale-95 transition-all">
              å¼€å§‹ç‚¹é¤
            </button>
          </div>
        );

        if (step === 'ordering') return (
          <div className="h-full flex flex-col bg-slate-50 fade-in pt-ios-safe">
            <header className="p-6 pt-12 pb-6 bg-white flex justify-between items-center">
              <div>
                <h1 className="text-2xl font-black text-slate-800 tracking-tight">ä»Šæ—¥èœå•</h1>
                <div className="flex items-center gap-2 mt-1">
                    <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    <p className="text-slate-400 text-[11px] font-bold tracking-widest uppercase">Table A-08</p>
                </div>
              </div>
              <div className="bg-orange-50 px-4 py-2 rounded-2xl border border-orange-100">
                <p className="text-[10px] text-orange-600 font-bold text-center">ç´¯è®¡ç§¯åˆ†</p>
                <p className="text-xl font-black text-orange-500 text-center leading-none mt-1">{totalHistory}</p>
              </div>
            </header>

            <div className="flex flex-1 overflow-hidden">
              <div className="w-20 bg-slate-100/50 flex flex-col pt-4 overflow-y-auto no-scrollbar">
                {['å¿…é€‰é¡¹', 'çƒ­èœ', 'ä¸»é£Ÿ', 'é¥®å“'].map(cat => (
                  <button key={cat} onClick={() => setActiveCat(cat)}
                    className={`w-full py-5 text-xs font-bold transition-all relative ${activeCat === cat ? 'text-red-600' : 'text-slate-400'}`}>
                    {activeCat === cat && <div className="absolute left-0 top-2 bottom-2 w-1.5 bg-red-600 rounded-r-full shadow-[2px_0_8px_rgba(220,38,38,0.2)]"></div>}
                    <span className={activeCat === cat ? 'scale-110 block transition-transform' : ''}>{cat}</span>
                  </button>
                ))}
              </div>
              <div className="flex-1 overflow-y-auto p-4 no-scrollbar bg-white rounded-tl-[32px] shadow-inner">
                {MENU_DATA.filter(i => i.category === activeCat).map(item => (
                  <div key={item.id} className="flex gap-4 mb-6 p-2 rounded-2xl hover:bg-slate-50 transition-colors fade-in">
                    <div className="w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center text-3xl shadow-sm border border-slate-50">
                      {item.category === 'é¥®å“' ? 'ğŸ¥¤' : item.category === 'ä¸»é£Ÿ' ? 'ğŸš' : 'ğŸ¥˜'}
                    </div>
                    <div className="flex-1 flex flex-col justify-between py-0.5">
                      <div>
                        <h3 className="font-bold text-slate-800 text-sm flex items-center gap-1">
                            {item.name}
                            {item.must && <span className="bg-red-100 text-red-600 text-[9px] px-1.5 py-0.5 rounded-md">å¿…é€‰</span>}
                        </h3>
                        <p className="text-[10px] text-slate-400 mt-0.5 line-clamp-1 italic">{item.desc}</p>
                      </div>
                      <div className="flex justify-between items-center mt-2">
                        <span className="text-red-600 font-black text-sm">{item.price} <span className="text-[10px] opacity-60 italic">PTS</span></span>
                        <div className="flex items-center gap-3">
                          {cart[item.id] > 0 && (
                            <button onClick={() => {
                              const newCart = {...cart};
                              newCart[item.id]--;
                              if(newCart[item.id] <= 0) delete newCart[item.id];
                              setCart(newCart);
                            }} className="w-6 h-6 rounded-lg border border-slate-200 flex items-center justify-center text-slate-400 active:bg-slate-100">-</button>
                          )}
                          {cart[item.id] > 0 && <span className="text-sm font-black text-slate-700">{cart[item.id]}</span>}
                          <button onClick={() => setCart({...cart, [item.id]: (cart[item.id] || 0) + 1})} 
                            className="w-7 h-7 bg-slate-900 text-white rounded-lg flex items-center justify-center shadow-lg active:scale-90 transition-transform font-bold text-lg">+</button>
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            <footer className="p-6 bg-white border-t border-slate-50 pb-ios-safe">
              {currentTotal > 0 && !hasMust && (
                <div className="flex justify-center mb-4">
                    <span className="px-4 py-1.5 bg-red-50 text-red-500 text-[10px] rounded-full font-bold animate-bounce shadow-sm">
                       ğŸ‘† è¯·è®°å¾—å‹¾é€‰â€œäº²è‡ªä¸‹å¨â€å¿…é€‰é¡¹å“¦
                    </span>
                </div>
              )}
              <button disabled={currentTotal === 0 || !hasMust} onClick={() => setStep('checkout')}
                className={`w-full h-16 rounded-2xl flex items-center justify-between px-8 transition-all duration-300 mb-4 ${currentTotal > 0 && hasMust ? 'bg-red-600 shadow-red active:scale-95' : 'bg-slate-200'}`}>
                <div className="text-left">
                    <p className="text-white/60 text-[10px] font-bold uppercase">Total Amount</p>
                    <span className="font-black text-xl text-white">{currentTotal} <span className="text-xs">ç§¯åˆ†</span></span>
                </div>
                <span className="font-black text-white text-sm bg-white/20 px-4 py-2 rounded-xl">ç»“ç®— &rarr;</span>
              </button>
            </footer>
          </div>
        );

        if (step === 'checkout') return (
          <div className="h-full flex flex-col bg-slate-50 fade-in pt-ios-safe">
            <header className="p-6 pt-12 flex items-center justify-between bg-white border-b border-slate-50">
              <button onClick={() => setStep('ordering')} className="w-10 h-10 flex items-center justify-center bg-slate-50 rounded-full text-slate-400 active:scale-90 transition-all">â†</button>
              <h1 className="text-lg font-black tracking-tight text-slate-800">æ ¸å¯¹è®¢å•æ¸…å•</h1>
              <div className="w-10"></div>
            </header>
            <div className="flex-1 p-6 overflow-y-auto no-scrollbar">
              <div className="bg-white rounded-[32px] p-8 shadow-soft mb-8 border border-slate-50 relative overflow-hidden">
                <div className="absolute top-0 right-0 w-24 h-24 bg-red-50 rounded-bl-full -mr-10 -mt-10 opacity-50"></div>
                {Object.keys(cart).map(id => {
                  const item = MENU_DATA.find(m => m.id == id);
                  return (
                    <div key={id} className="flex justify-between items-center mb-5 relative z-10">
                      <div>
                        <p className="text-slate-700 font-bold text-sm">{item.name}</p>
                        <p className="text-[10px] text-slate-400">æ•°é‡ Ã— {cart[id]}</p>
                      </div>
                      <span className="font-black text-slate-900 text-sm">{item.price * cart[id]} <span className="text-[10px] text-slate-400">PTS</span></span>
                    </div>
                  )
                })}
                <div className="border-t border-dashed border-slate-200 mt-6 pt-6 flex justify-between items-center">
                  <span className="font-bold text-slate-400 text-sm italic">Grand Total</span>
                  <span className="text-3xl font-black text-red-600">{currentTotal} <span className="text-sm">ç§¯åˆ†</span></span>
                </div>
              </div>
              <div className="px-4">
                <div className="flex justify-between items-end mb-3">
                    <p className="text-xs font-bold text-slate-500 uppercase tracking-tighter">ğŸ¯ Wish Progress</p>
                    <p className="text-xs font-black text-orange-500">{totalHistory + currentTotal} / 100</p>
                </div>
                <div className="h-4 bg-white rounded-full p-1 shadow-inner overflow-hidden border border-slate-100">
                  <div className="h-full bg-gradient-to-r from-orange-400 to-yellow-400 rounded-full transition-all duration-1000 progress-glow" 
                       style={{width: `${Math.min(totalHistory + currentTotal, 100)}%`}}></div>
                </div>
              </div>
            </div>
            <footer className="p-6 bg-white pb-ios-safe border-t border-slate-50">
              <button onClick={() => { setTotalHistory(totalHistory + currentTotal); setStep('success'); }} 
                className="w-full bg-slate-900 text-white h-16 rounded-2xl font-black text-lg shadow-2xl active:scale-95 transition-all mb-4">ç¡®è®¤æ”¯ä»˜å¹¶ä¸‹å•</button>
            </footer>
          </div>
        );

        if (step === 'success') return (
          <div className="h-full bg-white flex flex-col items-center justify-center p-10 text-center fade-in pt-ios-safe pb-ios-safe">
            <div className="w-24 h-24 bg-green-50 rounded-[32px] flex items-center justify-center text-4xl mb-8 shadow-inner border border-green-100 animate-bounce">âœ…</div>
            <h1 className="text-3xl font-black mb-2 text-slate-800 tracking-tight">ä¸‹å•æˆåŠŸå•¦ï¼</h1>
            <p className="text-slate-400 text-xs mb-10 tracking-widest font-light uppercase text-center">Chef is preparing your love...</p>
            <div className="w-full bg-slate-50 rounded-[40px] p-10 mb-10 border border-slate-100 shadow-inner relative">
              <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white px-4 py-1 rounded-full border border-slate-100 text-[10px] font-black text-slate-300 uppercase tracking-widest text-center">Order Ticket</div>
              <p className="text-[10px] text-slate-400 mb-2 uppercase font-bold text-center">å–é¤å‡­è¯</p>
              <p className="text-5xl font-black tracking-[0.2em] text-red-600 drop-shadow-sm text-center">5201314</p>
            </div>
            <div className="w-full px-4 mb-14">
                <div className="flex justify-between items-end mb-2 px-1">
                    <span className="text-[10px] font-black text-slate-400 uppercase">Current Progress</span>
                    <span className="text-[10px] font-black text-orange-500">{totalHistory}%</span>
                </div>
                <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                    <div className="h-full bg-gradient-to-r from-orange-400 to-yellow-400 transition-all duration-1000" style={{width: `${Math.min(totalHistory, 100)}%`}}></div>
                </div>
            </div>
            <button onClick={() => { setCart({}); setStep('welcome'); }} 
              className="bg-slate-900 text-white px-16 py-4 rounded-2xl font-black shadow-xl active:scale-95 transition-all">è¿”å›é¦–é¡µ</button>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
